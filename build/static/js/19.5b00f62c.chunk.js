(this["webpackJsonpFleek-Admin-Portal"]=this["webpackJsonpFleek-Admin-Portal"]||[]).push([[19],{1697:function(e,t,a){"use strict";a.r(t);var n=a(126),i=a(127),r=a(288),o=a(129),l=a(128),s=a(0),c=a.n(s),d=a(1355),u=a(953),g=a(436),m=a(1015),h=a(1016),_=a(1088),y=a(136),p=a(1738),f=a(1735),b=a(959),E=a(105),v=a(1079),C=a(1742),w=a(1688),S=a(1089),k=a.n(S),M=a(287),A=d.a.Meta,V=u.a.Option,j=function(e){Object(o.a)(a,e);var t=Object(l.a)(a);function a(e){var i;return Object(n.a)(this,a),(i=t.call(this,e)).handleChange=function(e){i.setState({is_pic_change:!0}),"uploading"!==e.file.status?"done"===e.file.status&&(i.setState({image_obj:e.file.originFileObj}),i.getBase64(e.file.originFileObj,(function(e){return i.setState({category_picture:e,loading:!1})}))):i.setState({loading:!0})},i.handleChangeAdd=function(e){"uploading"!==e.file.status?"done"===e.file.status&&(i.setState({new_image_obj:e.file.originFileObj}),i.getBase64(e.file.originFileObj,(function(e){return i.setState({new_sub_category_picture:e,loading:!1})}))):i.setState({loading:!0})},i.state={categories_data:[],sub_categories_data:[],category_id:"",is_sub_cat:!1,isLoading:!0,viewEditModal:!1,viewDeleteModal:!1,sub_category_id:"",sub_category_title:"",sub_category_picture:"",is_pic_change:!1,new_sub_category_title:"",new_sub_category_picture:""},i.handleChangeCategory=i.handleChangeCategory.bind(Object(r.a)(i)),i}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch(M.api_base_url+"listAllCategories",M.method_post).then((function(e){return e.json()})).then((function(t){e.setState({categories_data:t.data,isLoading:!1})})).catch()}},{key:"handleChangeCategory",value:function(e){var t=this;this.setState({category_id:e}),this.setState({isLoading:!0});var a={method:M.method,headers:M.headers,body:JSON.stringify({category_id:e})};fetch(M.api_base_url+"listAllSubCategories",a).then((function(e){return e.json()})).then((function(e){t.setState({sub_categories_data:e.data,is_sub_cat:!0,isLoading:!1})})).catch()}},{key:"handleEditCategory",value:function(e){this.setState({sub_category_id:e.id,sub_category_title:e.sub_category_name,sub_category_picture:e.picture}),this.setViewEditModal(!0)}},{key:"handleDeleteCategory",value:function(e){this.setState({sub_category_id:e.id}),this.setViewDeleteModal(!0)}},{key:"setViewEditModal",value:function(e){this.setState({viewEditModal:e})}},{key:"setViewDeleteModal",value:function(e){this.setState({viewDeleteModal:e})}},{key:"setViewAddModal",value:function(e){this.setState({viewAddModal:e})}},{key:"confirmDeleteCategory",value:function(e){var t=this;this.setViewDeleteModal(!1);var a={method:"DELETE",headers:M.headers,body:JSON.stringify({sub_category_id:e})};fetch(M.api_base_url+"deleteSubCategory",a).then((function(e){return e.json()})).then((function(e){g.b.success("Removed Successfully"),t.setState({isLoading:!0}),t.handleChangeCategory(t.state.category_id)})).catch()}},{key:"confirmEditCategory",value:function(e){var t=this;this.setViewEditModal(!1);var a=new FormData;!0===this.state.is_pic_change&&a.append("image",this.state.image_obj),a.append("sub_category_name",this.state.sub_category_title),a.append("sub_category_id",e),a.append("is_pic_change",this.state.is_pic_change),k.a.put(M.api_base_url+"editSubCategory",a,M.axios_config).then((function(e){e.data.status?(g.b.success(e.data.message),t.setState({isLoading:!0}),t.handleChangeCategory(t.state.category_id)):g.b.error(e.data.message)})).catch((function(e){g.b.error("Something went wrong!",e)}))}},{key:"confirmAddCategory",value:function(){var e=this;this.setViewAddModal(!1);var t=new FormData;t.append("image",this.state.new_image_obj),t.append("sub_category_name",this.state.new_sub_category_title),t.append("category_id",this.state.category_id),k.a.post(M.api_base_url+"addSubCategory",t,M.axios_config).then((function(t){t.data.status?(g.b.success(t.data.message),e.setState({isLoading:!0}),e.handleChangeCategory(e.state.category_id)):g.b.error(t.data.message)})).catch((function(e){g.b.error("Something went wrong!",e)}))}},{key:"getBase64",value:function(e,t){var a=new FileReader;a.addEventListener("load",(function(){return t(a.result)})),a.readAsDataURL(e)}},{key:"beforeUpload",value:function(e){var t="image/jpeg"===e.type||"image/png"===e.type;t||g.b.error("You can only upload JPG/PNG file!");var a=e.size/1024/1024<2;return a||g.b.error("Image must smaller than 2MB!"),t&&a}},{key:"render",value:function(){var e=this,t=this.state,a=t.categories_data,n=t.sub_categories_data,i=t.is_sub_cat,r=t.isLoading,o=t.viewEditModal,l=t.viewDeleteModal,s=t.viewAddModal,g=c.a.createElement(E.a,{style:{fontSize:24},spin:!0}),S=this.state,k=S.loading,M=S.sub_category_picture,j=S.sub_category_title,D=S.sub_category_id,N=S.new_sub_category_picture,L=S.new_sub_category_title,O=c.a.createElement("div",null,k?c.a.createElement(E.a,null):c.a.createElement(v.a,null),c.a.createElement("div",{style:{marginTop:8}},"Upload"));return c.a.createElement("div",null,c.a.createElement(m.a,null,c.a.createElement(h.a,{span:24},c.a.createElement("h2",{className:"title gx-mb-4"},"Sub Categories"),c.a.createElement("div",{style:{marginBottom:"1%"}},c.a.createElement(u.a,{defaultValue:"Select Category",style:{width:"30%"},onChange:this.handleChangeCategory},a.map((function(e){return c.a.createElement(V,{value:e.id},e.category_name)}))))),r?c.a.createElement(h.a,{span:24},c.a.createElement(_.a,{indicator:g})):c.a.createElement(c.a.Fragment,null,i?c.a.createElement(h.a,{span:24},c.a.createElement(y.a,{type:"primary",onClick:function(){return e.setViewAddModal(!0)}},"Add"),c.a.createElement("div",{className:"site-card-wrapper"},c.a.createElement(m.a,{gutter:16},n.map((function(t,a){return c.a.createElement(h.a,{span:6},c.a.createElement(d.a,{style:{width:300},cover:c.a.createElement("img",{alt:t.picture,src:t.picture,width:"300px",height:"125px"}),actions:[c.a.createElement(C.a,{key:"edit",onClick:function(){return e.handleEditCategory(t)}}),c.a.createElement(w.a,{key:"delete",onClick:function(){return e.handleDeleteCategory(t)}})]},c.a.createElement(A,{title:t.sub_category_name})))}))))):null)),c.a.createElement(p.a,{centered:!0,visible:o,footer:null,header:null,onCancel:function(){return e.setViewEditModal(!1)}},c.a.createElement(m.a,{gutter:16},c.a.createElement(h.a,{span:8},c.a.createElement(f.a,{name:"avatar",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",beforeUpload:this.beforeUpload,onChange:this.handleChange},M?c.a.createElement("img",{src:M,alt:"avatar",style:{width:"100%"}}):O),c.a.createElement(b.a,{id:"sub_cat_name",size:"large",placeholder:"Sub Category Name",defaultValue:j,onChange:function(t){return e.setState({sub_category_title:t.target.value})}}))),c.a.createElement("br",null),c.a.createElement("div",{className:"gx-card-list-footer"},c.a.createElement(y.a,{type:"primary",onClick:function(){return e.confirmEditCategory(D)}},"Update"),c.a.createElement(y.a,{onClick:function(){return e.setViewEditModal(!1)}},"Cancel"))),c.a.createElement(p.a,{centered:!0,visible:l,footer:null,header:null,onCancel:function(){return e.setViewDeleteModal(!1)}},c.a.createElement("p",{className:"gx-text-grey gx-mb-2"},"Are you sure you want to delete ",j,"?"),c.a.createElement("div",{className:"gx-card-list-footer"},c.a.createElement(y.a,{type:"primary",onClick:function(){return e.confirmDeleteCategory(D)}},"Yes"),c.a.createElement(y.a,{onClick:function(){return e.setViewDeleteModal(!1)}},"No"))),c.a.createElement(p.a,{centered:!0,visible:s,footer:null,header:null,onCancel:function(){return e.setViewAddModal(!1)}},c.a.createElement(m.a,{gutter:16},c.a.createElement(h.a,{span:8},c.a.createElement(f.a,{name:"avatar",listType:"picture-card",className:"avatar-uploader",showUploadList:!1,action:"https://www.mocky.io/v2/5cc8019d300000980a055e76",beforeUpload:this.beforeUpload,onChange:this.handleChangeAdd},N?c.a.createElement("img",{src:N,alt:"avatar",style:{width:"100%"}}):O),c.a.createElement(b.a,{size:"large",placeholder:"Category Name",defaultValue:L,onChange:function(t){return e.setState({new_sub_category_title:t.target.value})}}))),c.a.createElement("br",null),c.a.createElement("div",{className:"gx-card-list-footer"},c.a.createElement(y.a,{type:"primary",onClick:function(){return e.confirmAddCategory()}},"Add"),c.a.createElement(y.a,{onClick:function(){return e.setViewAddModal(!1)}},"Cancel"))))}}]),a}(c.a.Component);t.default=j}}]);
//# sourceMappingURL=19.5b00f62c.chunk.js.map